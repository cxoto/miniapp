<view class="editor-container">
  <!-- é¡¶éƒ¨å ä½ï¼Œè®©å†…å®¹ä»èƒ¶å›ŠæŒ‰é’®ä¸‹æ–¹å¼€å§‹ -->
  <view class="top-spacer" style="height: {{contentTop}}px;"></view>

  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <view class="nav-bar">
    <view class="nav-left">
      <view class="back-btn" bindtap="goBack">
        <text class="back-icon">â€¹</text>
        <text class="back-text">å¤‡å¿˜å½•</text>
      </view>
    </view>
    <view class="nav-right">
      <view class="nav-btn" bindtap="showShare">
        <text class="nav-icon">â†—</text>
      </view>
      <view class="nav-btn" bindtap="showMore">
        <text class="nav-icon">Â·Â·Â·</text>
      </view>
    </view>
  </view>

  <!-- ç¼–è¾‘åŒºåŸŸ -->
  <scroll-view class="editor-scroll" scroll-y="{{true}}">
    <view class="editor-content">
      <!-- æ—¥æœŸä¿¡æ¯ -->
      <view class="note-date">
        <text>{{dateStr}}</text>
      </view>

      <!-- æ ‡é¢˜è¾“å…¥ -->
      <input
        class="title-input"
        placeholder="æ ‡é¢˜"
        placeholder-class="placeholder"
        value="{{title}}"
        bindinput="onTitleInput"
        bindconfirm="onTitleConfirm"
        focus="{{titleFocus}}"
        confirm-type="next"
      />

      <!-- å†…å®¹è¾“å…¥ -->
      <textarea
        class="content-input"
        placeholder="å¼€å§‹è¾“å…¥..."
        placeholder-class="placeholder"
        value="{{content}}"
        bindinput="onContentInput"
        focus="{{contentFocus}}"
        auto-height="{{true}}"
        show-confirm-bar="{{false}}"
      />
    </view>
  </scroll-view>

  <!-- åº•éƒ¨å·¥å…·æ  -->
  <view class="toolbar" wx:if="{{showToolbar}}">
    <view class="toolbar-center">
      <text class="char-count">{{charCount}} å­—ç¬¦</text>
    </view>
    <view class="toolbar-right">
      <view class="tool-btn new" bindtap="goBack">
        <text class="tool-icon">âœ</text>
      </view>
    </view>
  </view>

  <!-- æ ¼å¼èœå• -->
  <view class="format-menu {{showFormatMenu ? 'visible' : ''}}" wx:if="{{showFormatMenu}}">
    <view class="format-item" bindtap="insertChecklist">
      <text class="format-icon">â˜‘</text>
      <text class="format-label">æ¸…å•</text>
    </view>
    <view class="format-item" bindtap="insertTable">
      <text class="format-icon">âŠ</text>
      <text class="format-label">è¡¨æ ¼</text>
    </view>
  </view>

  <!-- åˆ†äº«èœå• -->
  <view class="modal-mask {{showShareMenu ? 'visible' : ''}}" wx:if="{{showShareMenu}}" bindtap="hideShare">
    <view class="action-sheet" catchtap="preventBubble">
      <view class="action-header">
        <text class="action-title">åˆ†äº«å¤‡å¿˜å½•</text>
      </view>
      <view class="action-content">
        <view class="action-item" bindtap="copyContent">
          <view class="action-icon-wrapper">
            <text class="action-icon">ğŸ“‹</text>
          </view>
          <text class="action-label">æ‹·è´</text>
        </view>
      </view>
      <view class="action-cancel" bindtap="hideShare">
        <text>å–æ¶ˆ</text>
      </view>
    </view>
  </view>

  <!-- æ›´å¤šèœå• -->
  <view class="modal-mask {{showMoreMenu ? 'visible' : ''}}" wx:if="{{showMoreMenu}}" bindtap="hideMore">
    <view class="action-sheet" catchtap="preventBubble">
      <view class="action-list">
        <view class="action-row" bindtap="togglePin">
          <text class="row-icon">ğŸ“Œ</text>
          <text class="row-label">{{note.isPinned ? 'å–æ¶ˆç½®é¡¶' : 'ç½®é¡¶å¤‡å¿˜å½•'}}</text>
        </view>
        <view class="action-row" bindtap="showFolderSelector">
          <text class="row-icon">ğŸ“</text>
          <text class="row-label">ç§»åŠ¨å¤‡å¿˜å½•</text>
          <text class="row-value">{{currentFolder.name || 'å¤‡å¿˜å½•'}}</text>
        </view>
        <view class="action-row delete" bindtap="deleteNote">
          <text class="row-icon">ğŸ—‘ï¸</text>
          <text class="row-label">åˆ é™¤å¤‡å¿˜å½•</text>
        </view>
      </view>
      <view class="action-cancel" bindtap="hideMore">
        <text>å–æ¶ˆ</text>
      </view>
    </view>
  </view>

  <!-- æ–‡ä»¶å¤¹é€‰æ‹©å™¨ -->
  <view class="modal-mask {{showFolderPicker ? 'visible' : ''}}" wx:if="{{showFolderPicker}}" bindtap="hideFolderSelector">
    <view class="folder-picker" catchtap="preventBubble">
      <view class="picker-header">
        <view class="picker-cancel" bindtap="hideFolderSelector">å–æ¶ˆ</view>
        <text class="picker-title">ç§»åŠ¨åˆ°</text>
        <view class="picker-placeholder"></view>
      </view>
      <scroll-view class="picker-list" scroll-y="{{true}}">
        <view
          class="picker-item {{note.folderId === item.id ? 'active' : ''}}"
          wx:for="{{folders}}"
          wx:key="id"
          bindtap="selectFolder"
          data-id="{{item.id}}"
        >
          <view class="picker-icon-wrapper" style="background-color: {{item.color}}">
            <text class="picker-icon">{{item.icon}}</text>
          </view>
          <text class="picker-name">{{item.name}}</text>
          <text class="picker-check" wx:if="{{note.folderId === item.id}}">âœ“</text>
        </view>
      </scroll-view>
    </view>
  </view>
</view>
